SELECT tab01.idsituacao_manifestacao, tab01.descricao_situacao_manifestacao,tab01.descricao_assunto, quantidade, quantidade_total
FROM (SELECT
	   COALESCE (man.situacao_manifestacao_idsituacao_manifestacao, '0') AS situacao_manifestacao,
	   COALESCE (a.idassunto, 0) AS idassunto,
	   COALESCE ( a.descricao, '0') AS descricao_assunto,
       COALESCE (sitman.idsituacao_manifestacao, 0) AS idsituacao_manifestacao,
       COALESCE ( sitman.descricao, '0') AS descricao_situacao_manifestacao,
	   COUNT(*) AS quantidade
FROM situacao_manifestacao sitman
INNER JOIN manifestacao man ON (sitman.idsituacao_manifestacao = man.situacao_manifestacao_idsituacao_manifestacao)
INNER JOIN assunto a ON (a.idassunto = man.assunto_idassunto )
WHERE sitman.descricao = "Resolvida"
GROUP BY idsituacao_manifestacao, descricao_assunto) as tab01
INNER JOIN
(SELECT COALESCE(man.situacao_manifestacao_idsituacao_manifestacao, 0) AS situacao_manifestacao,
	   COUNT(*) AS quantidade_total
FROM manifestacao man
INNER JOIN situacao_manifestacao sitman ON  (man.situacao_manifestacao_idsituacao_manifestacao = sitman.idsituacao_manifestacao)
INNER JOIN assunto a ON (a.idassunto = man.assunto_idassunto)
WHERE a.idassunto = man.assunto_idassunto AND  sitman.idsituacao_manifestacao = man.situacao_manifestacao_idsituacao_manifestacao
GROUP BY idsituacao_manifestacao) AS tab02
ON (tab01.idsituacao_manifestacao = tab02.situacao_manifestacao)
;
