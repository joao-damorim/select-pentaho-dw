SELECT tab01.descricao_assunto, quantidade_resolvida, quantidade_total
FROM (SELECT
	   COALESCE(man.situacao_manifestacao_idsituacao_manifestacao, '0') AS situacao_manifestacao,
	   COALESCE(a.idassunto, 0) AS idassunto,
	   COALESCE(a.descricao, '0') AS descricao_assunto,
       COALESCE(sitman.idsituacao_manifestacao, 0) AS idsituacao_manifestacao,
       COALESCE(sitman.descricao, '0') AS descricao_situacao_manifestacao,
	   COUNT(*) AS quantidade_resolvida
FROM situacao_manifestacao sitman
INNER JOIN manifestacao man ON (sitman.idsituacao_manifestacao = man.situacao_manifestacao_idsituacao_manifestacao)
INNER JOIN assunto a ON (a.idassunto = man.assunto_idassunto )
WHERE sitman.descricao = "Resolvida"
GROUP BY descricao_assunto) as tab01
INNER JOIN
(SELECT
	   COALESCE(a.idassunto, 0) AS idassunto,
	   COALESCE(a.descricao, '0') AS descricao_assunto,
	   COUNT(*) AS quantidade_total
FROM situacao_manifestacao sitman
INNER JOIN manifestacao man ON (sitman.idsituacao_manifestacao = man.situacao_manifestacao_idsituacao_manifestacao)
INNER JOIN assunto a ON (a.idassunto = man.assunto_idassunto )
GROUP BY idassunto) as tab02
ON (tab01.idassunto = tab02.idassunto)
;
